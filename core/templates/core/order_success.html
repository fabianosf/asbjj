{% extends 'base.html' %}
{% load static %}

{% block title %}Pedido Confirmado - ASBJJ{% endblock %}
{% block description %}Seu pedido foi confirmado com sucesso{% endblock %}

{% block extra_css %}
<style>
.success-header {
  background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
  color: white;
  padding: 3rem 0;
  text-align: center;
}

.success-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
}

.order-details {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  margin-bottom: 2rem;
}

.order-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 0;
  border-bottom: 1px solid #dee2e6;
}

.order-item:last-child {
  border-bottom: none;
}

.order-item-image {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 6px;
}

.next-steps {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 2rem;
}

.step {
  display: flex;
  align-items: center;
  margin-bottom: 1rem;
}

.step-number {
  background: #007bff;
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 1rem;
  font-weight: bold;
}

.step.completed .step-number {
  background: #28a745;
}

.step.current .step-number {
  background: #ffc107;
  color: #000;
}
</style>
{% endblock %}

{% block content %}
<!-- Header de Sucesso -->
<div class="success-header">
  <div class="container">
    <div class="success-icon">
      <i class="fas fa-check-circle"></i>
    </div>
    <h1 class="mb-3">Pedido Confirmado!</h1>
    <p class="lead mb-0">Obrigado por escolher a ASBJJ. Seu pedido foi recebido com sucesso.</p>
  </div>
</div>

<div class="container my-4">
  {% if order %}
  <div class="row">
    <!-- Detalhes do Pedido -->
    <div class="col-lg-8">
      <div class="order-details">
        <h3 class="mb-4">Detalhes do Pedido</h3>
        
        <div class="row mb-4">
          <div class="col-md-6">
            <strong>Número do Pedido:</strong><br>
            <span class="text-primary">{{ order.order_number }}</span>
          </div>
          <div class="col-md-6">
            <strong>Data do Pedido:</strong><br>
            {{ order.created_at|date:"d/m/Y H:i" }}
          </div>
        </div>
        
        <h5 class="mb-3">Itens do Pedido</h5>
        {% for item in order.items.all %}
        <div class="order-item">
          <div class="d-flex align-items-center">
            <img src="{{ item.product.main_image.url }}" class="order-item-image me-3" alt="{{ item.product.name }}">
            <div>
              <div class="fw-bold">{{ item.product.name }}</div>
              <small class="text-muted">Quantidade: {{ item.quantity }}</small>
            </div>
          </div>
          <div class="text-end">
            <div class="fw-bold">R$ {{ item.total_price|floatformat:2 }}</div>
            <small class="text-muted">R$ {{ item.price|floatformat:2 }} cada</small>
          </div>
        </div>
        {% endfor %}
        
        <hr>
        
        <div class="row">
          <div class="col-md-6">
            <h6>Endereço de Entrega</h6>
            <address>
              {{ order.customer_name }}<br>
              {{ order.shipping_address }}<br>
              {{ order.shipping_city }} - {{ order.shipping_state }}<br>
              CEP: {{ order.shipping_zip_code }}
            </address>
          </div>
          <div class="col-md-6">
            <h6>Informações de Contato</h6>
            <p>
              <strong>E-mail:</strong> {{ order.customer_email }}<br>
              <strong>Telefone:</strong> {{ order.customer_phone }}
            </p>
          </div>
        </div>
        
        <hr>
        
        <div class="row">
          <div class="col-md-6">
            <h6>Resumo Financeiro</h6>
            <div class="d-flex justify-content-between">
              <span>Subtotal:</span>
              <span>R$ {{ order.subtotal|floatformat:2 }}</span>
            </div>
            <div class="d-flex justify-content-between">
              <span>Frete:</span>
              <span class="text-success">Grátis</span>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
              <strong>Total:</strong>
              <strong class="text-primary">R$ {{ order.total|floatformat:2 }}</strong>
            </div>
          </div>
          <div class="col-md-6">
            <h6>Método de Pagamento</h6>
            <p>
              <strong>{{ order.get_payment_method_display }}</strong><br>
              <small class="text-muted">Em breve entraremos em contato para finalizar o pagamento.</small>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Próximos Passos -->
    <div class="col-lg-4">
      <div class="next-steps">
        <h4 class="mb-4">Próximos Passos</h4>
        
        <div class="step completed">
          <div class="step-number">1</div>
          <div>
            <strong>Pedido Confirmado</strong><br>
            <small class="text-muted">Seu pedido foi recebido</small>
          </div>
        </div>
        
        <div class="step current">
          <div class="step-number">2</div>
          <div>
            <strong>Pagamento</strong><br>
            <small class="text-muted">Entraremos em contato em breve</small>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">3</div>
          <div>
            <strong>Preparação</strong><br>
            <small class="text-muted">Separando seus produtos</small>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">4</div>
          <div>
            <strong>Envio</strong><br>
            <small class="text-muted">Produtos a caminho</small>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">5</div>
          <div>
            <strong>Entrega</strong><br>
            <small class="text-muted">Produtos entregues</small>
          </div>
        </div>
        
        <hr class="my-4">
        
        <div class="text-center">
          <a href="{% url 'core:shop' %}" class="btn btn-primary">
            <i class="fas fa-shopping-bag me-2"></i>Continuar Comprando
          </a>
        </div>
        
        <div class="mt-3 text-center">
          <small class="text-muted">
            <i class="fas fa-envelope me-1"></i>
            Enviamos um e-mail de confirmação para {{ order.customer_email }}
          </small>
        </div>
      </div>
    </div>
  </div>

  {% else %}
  <!-- Erro -->
  <div class="text-center py-5">
    <div class="text-danger mb-3">
      <i class="fas fa-exclamation-triangle fa-3x"></i>
    </div>
    <h3>Pedido não encontrado</h3>
    <p class="text-muted">Não foi possível encontrar os detalhes do pedido.</p>
    <a href="{% url 'core:shop' %}" class="btn btn-primary">
      <i class="fas fa-shopping-bag me-2"></i>Ir para a Loja
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}
