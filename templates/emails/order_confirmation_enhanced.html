{% extends 'emails/base_email.html' %}

{% block title %}Pedido Confirmado - ASBJJ{% endblock %}

{% block content %}
<h2>✅ Seu Pedido Foi Confirmado!</h2>

<p>Olá, <strong>{{ order.customer_name }}</strong>!</p>

<p>Recebemos seu pedido com sucesso! Abaixo estão os detalhes da sua compra:</p>

<div class="info-box">
    <p><strong>📦 Número do Pedido:</strong> {{ order.order_number }}</p>
    <p><strong>📅 Data do Pedido:</strong> {{ order.created_at|date:"d/m/Y \à\s H:i" }}</p>
    <p><strong>💳 Status:</strong> {{ order.get_status_display }}</p>
    <p><strong>💵 Forma de Pagamento:</strong> {{ order.get_payment_method_display }}</p>
</div>

<h3>📋 Itens do Pedido:</h3>

<table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
    <thead>
        <tr style="background-color: #ecf0f1;">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Produto</th>
            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">Qtd</th>
            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Preço</th>
            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Subtotal</th>
        </tr>
    </thead>
    <tbody>
        {% for item in order.items.all %}
        <tr>
            <td style="padding: 12px; border: 1px solid #ddd;">{{ item.product.name }}</td>
            <td style="padding: 12px; text-align: center; border: 1px solid #ddd;">{{ item.quantity }}</td>
            <td style="padding: 12px; text-align: right; border: 1px solid #ddd;">R$ {{ item.price }}</td>
            <td style="padding: 12px; text-align: right; border: 1px solid #ddd;">R$ {{ item.get_total_price }}</td>
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr style="font-weight: bold; background-color: #f8f9fa;">
            <td colspan="3" style="padding: 12px; text-align: right; border: 1px solid #ddd;">Subtotal:</td>
            <td style="padding: 12px; text-align: right; border: 1px solid #ddd;">R$ {{ order.subtotal }}</td>
        </tr>
        {% if order.shipping_cost %}
        <tr>
            <td colspan="3" style="padding: 12px; text-align: right; border: 1px solid #ddd;">Frete:</td>
            <td style="padding: 12px; text-align: right; border: 1px solid #ddd;">R$ {{ order.shipping_cost }}</td>
        </tr>
        {% endif %}
        {% if order.discount %}
        <tr style="color: #27ae60;">
            <td colspan="3" style="padding: 12px; text-align: right; border: 1px solid #ddd;">Desconto:</td>
            <td style="padding: 12px; text-align: right; border: 1px solid #ddd;">- R$ {{ order.discount }}</td>
        </tr>
        {% endif %}
        <tr style="font-weight: bold; font-size: 18px; background-color: #e74c3c; color: white;">
            <td colspan="3" style="padding: 15px; text-align: right; border: 1px solid #ddd;">TOTAL:</td>
            <td style="padding: 15px; text-align: right; border: 1px solid #ddd;">R$ {{ order.total }}</td>
        </tr>
    </tfoot>
</table>

<h3>📬 Endereço de Entrega:</h3>
<div class="info-box">
    <p>{{ order.shipping_address }}</p>
    <p>{{ order.shipping_city }} - {{ order.shipping_state }}</p>
    <p>CEP: {{ order.shipping_zip_code }}</p>
</div>

{% if order.payment_method == 'credit_card' or order.payment_method == 'debit_card' %}
<div class="info-box" style="background-color: #d4edda; border-left-color: #27ae60;">
    <p><strong>✅ Pagamento Aprovado!</strong></p>
    <p>Seu pedido será processado em breve.</p>
</div>
{% elif order.payment_method == 'pix' %}
<div class="info-box" style="background-color: #fff3cd; border-left-color: #f39c12;">
    <p><strong>⏳ Aguardando Pagamento PIX</strong></p>
    <p>Após a confirmação do pagamento, processaremos seu pedido.</p>
</div>
{% elif order.payment_method == 'boleto' %}
<div class="info-box" style="background-color: #fff3cd; border-left-color: #f39c12;">
    <p><strong>⏳ Aguardando Pagamento do Boleto</strong></p>
    <p>O boleto foi enviado para seu e-mail. Após o pagamento, processaremos seu pedido.</p>
</div>
{% endif %}

<div style="text-align: center; margin-top: 30px;">
    <a href="{{ site_url }}/pedido/{{ order.id }}/" class="button">
        📦 Acompanhar Pedido
    </a>
</div>

<div class="divider"></div>

<h3>📱 Precisa de Ajuda?</h3>
<p>Entre em contato conosco:</p>
<ul style="list-style: none; padding: 0;">
    <li>💬 WhatsApp: <a href="https://wa.me/5521989307826">(21) 98930-7826</a></li>
    <li>📧 E-mail: <a href="mailto:contato@asbjj.com.br">contato@asbjj.com.br</a></li>
</ul>

<p style="margin-top: 30px; color: #7f8c8d; font-size: 14px;">
    Obrigado por comprar com a ASBJJ! 🥋
</p>
{% endblock %}
